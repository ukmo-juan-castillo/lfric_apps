&jedi_lfric_tests
test_field='theta',
/

#### Configure JEDI-LFRIC

&jedi_lfric_settings
forecast_length='P0DT6H0M0S'
/

&jedi_increment
variables='theta', 'rho', 'exner', 'u_in_w3', 'v_in_w3', 'w_in_wth', 'm_v', 'm_cl', 'm_r', 'm_ci',
inc_time='2018-04-14 21:00:00'
/

&jedi_state
variables='theta', 'rho', 'u10m', 'exner', 'u_in_w3', 'v_in_w3', 'w_in_wth', 'm_v', 'm_cl', 'm_r', 'm_ci',
state_time='2018-04-14 21:00:00',
use_pseudo_model=true
/

&jedi_geometry
io_time_step='P0DT1H0M0S',
io_calender_start='2018-04-14T21:00:00',
io_read_path='/data/users/lfric/data/jedi-lfric/Ticket4141/jedi_trajectory',
io_write_path='write_file'
/

&jedi_pseudo_model
initial_time='2018-04-14T21:00:00'
number_of_steps=9
time_step='P0DT1H0M0S'
/

#### Configure LFRic

&base_mesh
file_prefix='mesh_C12',
geometry='spherical',
prepartitioned=.false.,
prime_mesh_name='dynamics',
topology='fully_periodic',
/
&boundaries
limited_area=.false.,
/
&checks
limit_cfl=.false.,
/
&section_choice
dynamics='gungho',
external_forcing=.false.,
iau=.false.,
iau_surf=.false.,
/
&damping_layer
dl_base=40000.0,
dl_str=0.05,
dl_type='latitude',
/
&departure_points
horizontal_limit='none',
horizontal_method='timeaverage',
n_dep_pt_iterations=1,
vertical_limit='exponential',
vertical_method='timeaverage',
vertical_sorting=.false.,
/
&energy_correction
encorr_usage='none',
integral_method='fe',
/
&extrusion
domain_height=80000.0,
method='um_L70_50t_20s_80km',
number_of_layers=70,
planet_radius=6371229.0,
stretching_height=17507.0,
stretching_method='smooth',
/
&files
ancil_directory='/data/users/lfric/data/ancils/basic-gal/Quagga/C12/n96e_l70',
checkpoint_stem_name='',
diag_stem_name='',
orography_mean_ancil_path='orography/gmted_ramp2/qrparm.orog.ugrid',
start_dump_directory='',
start_dump_filename='',
/
&finite_element
cellshape='quadrilateral',
coord_order=1,
coord_system='native',
element_order=0,
rehabilitate=.true.,
vorticity_in_w1=.false.,
/
&formulation
dlayer_on=.true.,
dry_static_adjust=.true.,
eos_method='sampled',
exner_from_eos=.false.,
init_exner_bt=.true.,
l_multigrid=.false.,
lagged_orog=.false.,
moisture_formulation='traditional',
p2theta_vert=.true.,
rotating=.true.,
shallow=.true.,
si_momentum_equation=.false.,
use_multires_coupling=.false.,
use_physics=.false.,
use_wavedynamics=.true.,
vector_invariant=.false.,
/
&helmholtz_solver
fail_on_non_converged=.true.,
gcrk=8,
method='bicgstab',
monitor_convergence=.true.,
normalise=.true.,
preconditioner='tridiagonal',
si_pressure_a_tol=1.0e-8,
si_pressure_maximum_iterations=400,
si_pressure_tolerance=1.0e-4,
/
&idealised
f_lon_deg=0.0,
test='gravity_wave',
/
&ideal_surface
canopy_height=19.01,16.38,0.79,1.26,1.0,
leaf_area_index=5.0,4.0,1.5,1.5,1.5,
n_snow_layers=11*0,
snow_depth=11*0.0,
snow_layer_ice_mass=27*0.0,
snow_layer_temp=27*273.0,
snow_layer_thickness=27*0.0,
soil_moisture=15.86,98.861,274.35,862.27,
soil_temperature=284.508,286.537,289.512,293.066,
surf_tile_fracs=9*0.0,1.0,0.0,
surf_tile_temps=9*295.0,300.0,265.0,
tile_snow_mass=11*0.0,
/
&initialization
ancil_option='none',
coarse_aerosol_ancil=.false.,
coarse_orography_ancil=.false.,
init_option='analytic',
lbc_option='none',
ls_option='analytic',
n_orog_smooth=0,
read_w2h_wind=.true.,
sea_ice_source='ancillary',
snow_source='start_dump',
w0_orography_mapping=.false.,
/
&initial_density
density_background=0.1,
density_max=2.0,
r1=0.0,
r2=0.0,
x1=0.0,
x2=0.0,
y1=0.0,
y2=0.0,
z1=0.0,
z2=0.0,
/
&initial_pressure
method='sampled',
surface_pressure=1000.0e2,
/
&initial_temperature
bvf_square=0.0001,
pert_centre=120.0,
pert_width_scaling=1.0,
perturb='none',
theta_surf=300.0,
/
&initial_vapour
/
&initial_wind
nl_constant=0.0,
profile='none',
sbr_angle_lat=0.0,
sbr_angle_lon=0.0,
smp_init_wind=.false.,
u0=0.0,
v0=0.0,
wind_time_period=0.0,
/
&io
checkpoint_read=.false.,
checkpoint_write=.false.,
counter_output_suffix='counter.txt',
diag_active_files='lfric_diag',
diag_always_on_sampling=.false.,
diagnostic_frequency=8,
file_convention='UGRID',
nodal_output_on_w3=.false.,
subroutine_counters=.false.,
subroutine_timers=.true.,
timer_output_path='timer.txt',
use_xios_io=.true.,
write_conservation_diag=.false.,
write_diag=.true.,
write_dump=.false.,
write_fluxes=.false.,
write_minmax_tseries=.false.,
/
&linear
pert_option='analytic',
/
&logging
run_log_level='info',
/
&mixed_solver
eliminate_variables='discrete',
fail_on_non_converged=.true.,
gcrk=4,
guess_np1=.false.,
mixed_solver_a_tol=1.0e-3,
monitor_convergence=.true.,
normalise=.true.,
reference_reset_time=1800.0,
si_maximum_iterations=10,
si_method='block_gcr',
si_preconditioner='pressure',
si_tolerance=1.0e-1,
split_w=.true.,
/
&mixing
leonard_term=.false.,
smagorinsky=.false.,
viscosity=.false.,
viscosity_mu=0.0,
/
&esm_couple
l_esm_couple_test=.false.,
/
&orography
orog_init_option='ancil',
/
&partitioning
panel_decomposition='auto',
panel_xproc=1,
panel_yproc=1,
partitioner='cubedsphere',
/
&physics
/
&planet
cp=1005.0,
gravity=9.80665,
omega=7.292116E-5,
p_zero=100000.0,
rd=287.05,
scaling_factor=1.0,
/
&solver
gcrk=18,
maximum_iterations=13,
method='chebyshev',
monitor_convergence=.false.,
preconditioner='diagonal',
tolerance=1.0e-6,
/
&time
calendar='timestep',
calendar_origin='2018-04-14 21:00:00',
calendar_start='2018-04-14 21:00:00',
calendar_type='gregorian',
timestep_end='13',
timestep_start='1',
/
&timestepping
alpha=0.55,
dt=1800,
inner_iterations=1,
method='semi_implicit',
outer_iterations=1,
runge_kutta_method='forward_euler',
spinup_alpha=.false.,
tau_r=1.0,
tau_t=1.0,
tau_u=0.55,
/
&transport
adjust_theta=.false.,
adjust_vhv_wind=.false.
ageofair_reset_level=10,
broken_w2_projection=.false.,
calculate_detj='upwind',
cap_density_predictor=0.001,
cfl_mol_1d_stab=1.0,
cfl_mol_2d_stab=1.0,
cfl_mol_3d_stab=1.0,
cheap_update=.false.,
ffsl_splitting=5*1,
consistent_metric=.false.,
dep_pt_stencil_extent=3,
dry_field_name='density',
enforce_min_value=5*.false.,
equation_form=1,2,2,2,2,
extended_mesh=.false.,
ffsl_inner_order=1,
ffsl_outer_order=1,
ffsl_unity_3d=.false.
ffsl_vertical_order=5*2
field_names='density','potential_temperature','wind','moisture',
'con_tracer',
fv_horizontal_order=2,
fv_vertical_order=2,
horizontal_method=5*1,
horizontal_monotone=5*1,
log_space=.true.,.true.,.false.,.false.,.false.,
max_vert_cfl_calc='dep_point',
min_val_abs_tol=-1.0e-12,
min_val_max_iterations=10,
min_val_method='iterative',
min_value=0.0,0.0,-99999999.0,0.0,0.0,
oned_reconstruction=.false.,
operators='fv',
profile_size=5,
reversible=.false.,.true.,.false.,.false.,.false.,
runge_kutta_method='ssp3',
scheme=5*1,
si_outer_transport='none',
slice_order='parabola',
special_edges_high_order=.false.,
special_edges_monotone=5*1,
special_edges_treatment=.false.,
splitting=5*1,
substep_transport='off'
theta_dispersion_correction=.false.,
theta_variable='dry',
transport_ageofair=.false.,
use_density_predictor=.false.,
vertical_method=5*1,
vertical_monotone=5*1,
vertical_monotone_order=5*3,
vertical_sl_order='cubic',
/
&validity_test
number_gamma_values=2,
update_ls_frequency=1,
/
