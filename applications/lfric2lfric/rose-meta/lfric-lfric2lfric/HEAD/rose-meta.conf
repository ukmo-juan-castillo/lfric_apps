import=lfric-gungho/HEAD

[namelist:base_mesh]
compulsory=false

[namelist:base_mesh=prepartitioned]
compulsory=false
!!trigger=namelist:partitioning: .false.;

[namelist:lfric2lfric]
compulsory=true
description=
ns=namelist/lfri2lfric
title=lfric2lfric

[namelist:lfric2lfric=destination_geometry]
compulsory=true
description=The geometry on which the destination domain is embedded
!enumeration=true
fail-if=this == "'planar'" and namelist:lfric2lfric=destination_topology != "'non_periodic'";
help=Along with topology this describes the domain. The geometry is the shape
    =on which the domain is embedded. This is currently either 'spherical' or
    ='planar'.
ns=namelist/lfric2lfric/configuration
value-titles=Planar, Spherical
values='planar', 'spherical'

[namelist:lfric2lfric=destination_mesh_name]
compulsory=true
description=Tag-name for destination-mesh
fail-if=this == namelist:lfric2lfric=source_mesh_name ;
help=Mesh topologies are held in UGRID conformant NetCDF files which
    =may contain more than one mesh topology. This tag-name identifies
    =the mesh topology to use from the mesh file namelist:lfric2lfric=destination_meshfile_prefix.
ns=namelist/lfric2lfric/configuration
!string_length=default
type=character

[namelist:lfric2lfric=destination_meshfile_prefix]
compulsory=true
description=Location of destination 2D mesh input file(s) (prefix).
help=Input files for 2D meshes are in NetCDF file format. The mesh topologies in the file should
    =be conformant to UGRID convention.
    =
ns=namelist/lfric2lfric/configuration
!string_length=filename
type=character

[namelist:lfric2lfric=destination_topology]
compulsory=true
description=Describes the periodicity of the destination domain.
!enumeration=true
fail-if=this != "'fully_periodic'" and namelist:partitioning=partitioner == "'cubedsphere'" ;
help=Together with the geometry this describes the domain. The topology is the
    =periodicity of the base mesh. A mesh over the whole globe would have
    =spherical geometry and fully_periodic topology, while a regional model
    =on the sphere would have spherical geometry and non_periodic topology.
    =Note that to run a regional model in limited-area mode with lateral boundary
    =conditions, namelist:boundaries=limited_area also needs to be set to "true".
ns=namelist/lfric2lfric/configuration
value-titles=Fully-periodic, Non-periodic
values='fully_periodic', 'non_periodic'

[namelist:lfric2lfric=dst_ancil_directory]
compulsory=true
description=Directory for destination ancillary files
help=Path to the directory where LFRic ancillaries for the destination
    =mesh are stored
ns=namelist/lfric2lfric/configuration
!string_length=filename
type=character

[namelist:lfric2lfric=dst_orography_mean_ancil_path]
compulsory=true
description=Path to mean destination orography file from the destination
           =ancillary files directory
help=This file contains global surface altitude information used for
    =the destination orography
ns=namelist/lfric2lfric/configuration
!string_length=filename
type=character

[namelist:lfric2lfric=mode]
compulsory=true
description=Generate Initial Conditions (ics) or Lateral Boundary Conditions (lbc)
!enumeration=true
help=Indicates whether to generate data on the destination mesh from data
    =on the source mesh (ics), or whether to generate lateral boundary
    =conditions for a regional destination mesh from data on the source
    =mesh (lbc).
ns=namelist/lfric2lfric/configuration
trigger=namelist:lfric2lfric=source_file_lbc: 'lbc' ;
       =namelist:lfric2lfric=weight_file_lbc: 'lbc' ;
value-titles=Initial conditions,Boundary conditions
values='ics','lbc'

[namelist:lfric2lfric=origin_domain]
compulsory=true
description=The domain that will be the source of the values to be regridded.
!enumeration=true
help=The LAM domain can only be used as an origin domain when regridding
    =to another LAM mesh, lfric2lfric does not support LAM-to-global or
    =LAM-to-LBC regridding.
ns=namelist/lfric2lfric/configuration
sort-key=1
value-titles=global, LAM
values='global', 'LAM'

[namelist:lfric2lfric=prepartitioned_meshes]
compulsory=true
description=Load pre-partitioned source and destination meshes
help=Input mesh files may contain global meshes whose extents are intended to cover
    =the entire model domain.  These may require partitioning in to a number of local
    =meshes (1 per processor rank) at runtime depending on the number of ranks
    =requested to perform the regridding between the source and destination meshes.
    =
    =If prepartitioned meshes are not used the model will expect global meshes
    =in the mesh input file to be partitioned at runtime.
    =
    =For simplicity, pre-partitioning can not be selected individually for the
    =source and destination meshes.
    =
    =Note: With increasing mesh size, at some point prepartitioned meshes may become
    =      necessary.
    =
ns=namelist/lfric2lfric/configuration
trigger=namelist:partitioning: .false. ;
type=logical

[namelist:lfric2lfric=regrid_method]
compulsory=true
description=Regridding method
!enumeration=true
help=Method used to regrid between the source and destination mesh,
    =there are three options available:
    =
    = 'Inter-grid maps' : Use inter-grids maps which link suitable pairs
    =                     of input meshes. Inter-grid maps are restricted
    =                     to mesh pairs where cells on one mesh are a
    =                     gridded sub-division of cells from the other mesh.
    =                     These inter-grid maps are included in the mesh
    =                     files, if requested from the mesh generators when
    =                     configured to output multiple meshes.
    =
    = 'LFRic2LFRic'     : The regridding between the source and destination
    =                     grids is made through the weight files generated
    =                     by an external tool, applied by a lfric2lfric
    =                     kernel.
    =
    = 'Oasis'           : The regridding between the source and destination
    =                     grids is make through the weigh files generated
    =                     by an external tool, applied by the OASIS
    =                     library. The weight file is specified in the
    =                     OASIS namcouple file
    =
ns=namelist/lfric2lfric/configuration
trigger=namelist:lfric2lfric=weight_file: 'lfric2lfric' ;
       =namelist:lfric2lfric=weight_file_lbc: 'lfric2lfric' ;
value-titles=Inter-grid maps, LFRic2LFRic, Oasis
values='map','lfric2lfric','oasis'

[namelist:lfric2lfric=source_file_lbc]
compulsory=true
description=Location of the lbc source file
help=File from where lateral boundary conditions will be generated
    =
ns=namelist/lfric2lfric/configuration
!string_length=filename
type=character

[namelist:lfric2lfric=source_geometry]
compulsory=true
description=The geometry on which the source domain is embedded
!enumeration=true
fail-if=this == "'planar'" and namelist:lfric2lfric=source_topology != "'non_periodic'";
help=Along with topology this describes the domain. The geometry is the shape
    =on which the domain is embedded. This is currently either 'spherical' or
    ='planar'.
ns=namelist/lfric2lfric/configuration
value-titles=Planar, Spherical
values='planar', 'spherical'

[namelist:lfric2lfric=source_mesh_name]
compulsory=true
description=Tag-name for source-mesh
fail-if=this == namelist:lfric2lfric=destination_mesh_name ;
help=Mesh topologies are held in UGRID conformant NetCDF files which
    =may contain more than one mesh topology. This tag-name identifies
    =the mesh topology to use from the mesh file namelist:lfric2lfric=source_meshfile_prefix.
ns=namelist/lfric2lfric/configuration
!string_length=default
type=character

[namelist:lfric2lfric=source_meshfile_prefix]
compulsory=true
description=Location of source 2D mesh input file(s) (prefix).
fail-if=namelist:lfric2lfric=regrid_method == "'map'" and this != namelist:lfric2lfric=destination_meshfile_prefix ;
help=Input files for 2D meshes are in NetCDF file format. The mesh topologies in the file should
    =be conformant to UGRID convention.
    =
ns=namelist/lfric2lfric/configuration
!string_length=filename
type=character

[namelist:lfric2lfric=source_topology]
compulsory=true
description=Describes the periodicity of the source domain.
!enumeration=true
fail-if=this != "'fully_periodic'" and namelist:partitioning=partitioner == "'cubedsphere'" ;
help=Together with the geometry this describes the domain. The topology is the
    =periodicity of the base mesh. A mesh over the whole globe would have
    =spherical geometry and fully_periodic topology, while a regional model
    =on the sphere would have spherical geometry and non_periodic topology.
    =Note that to run a regional model in limited-area mode with lateral boundary
    =conditions, namelist:boundaries=limited_area also needs to be set to "true".
ns=namelist/lfric2lfric/configuration
value-titles=Fully-periodic, Non-periodic
values='fully_periodic', 'non_periodic'

[namelist:lfric2lfric=src_ancil_directory]
compulsory=true
description=Directory for source ancillary files
help=Path to the directory where LFRic ancillaries for the source
    =mesh are stored
ns=namelist/lfric2lfric/configuration
!string_length=filename
type=character

[namelist:lfric2lfric=src_orography_mean_ancil_path]
compulsory=true
description=Path to mean source orography file from the source
           =ancillary files directory
help=This file contains global surface altitude information used for
    =the source orography
ns=namelist/lfric2lfric/configuration
!string_length=filename
type=character

[namelist:lfric2lfric=target_domain]
compulsory=true
description=The domain type that the source data will be regridded to.
!enumeration=true
fail-if=this == "'LBC'" and namelist:lfric2lfric=origin_domain == "'LAM'" # LAM cannot provide source values for LBC creation
       =this == "'global'" and namelist:lfric2lfric=origin_domain == "'LAM'" # LAM cannot currently be regrid into global
help=Target domains currently not supported include:
    =
    = origin => target
    = ----------------
    = LAM    => LBC
    = LAM    => global
    =
ns=namelist/lfric2lfric/configuration
sort-key=2
value-titles=global, LAM, LBC
values='global', 'LAM', 'LBC'

[namelist:lfric2lfric=weight_file]
compulsory=true
description=Weight file for ics mesh regridding
fail-if=this == '' ;
help=Location of the weight file used to interpolate
    =between the source and destination meshes
    =when creating checkpoint files
ns=namelist/lfric2lfric/configuration
!string_length=filename
type=character

[namelist:lfric2lfric=weight_file_lbc]
compulsory=true
description=Weight file for lbc mesh regridding
fail-if=this == '' ;
help=Location of the weight file used to interpolate
    =between the source and destination meshes
    =when creating lateral boundary files
ns=namelist/lfric2lfric/configuration
!string_length=filename
type=character

[namelist:partitioning]
duplicate=true
!instance_key_member=mesh_type

[namelist:partitioning=mesh_type]
compulsory=true
description=The purpose of the mesh
!enumeration=true
help=The mesh can be used to perform a LFRic forecast (Dynamics),
    =or to describe the source and the destination grids in
    =the lfric2lfric regridding program.
ns=namelist/lfric2lfric/configuration
value-titles=Dynamics, Source, Destination
values='dynamics', 'source', 'destination'
