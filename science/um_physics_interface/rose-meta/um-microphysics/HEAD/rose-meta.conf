#==============================================================================
# MICROPHYSICS
#==============================================================================

[namelist:microphysics]
compulsory=true
description=Microphysics parametrizations
ns=namelist/Science/UM Microphysics
sort-key=Section-A08
title=Microphysics

[namelist:microphysics=a_ratio_exp]
compulsory=true
description=Exponent in the cross-sectional area ratio relation ice
help=When the shape-dependent riming rates are used,
    =this is the exponent
    =used to specify the cross-sectional area of ice particles.
    =The cross-sectional area ratio is given as
    =R(D) = a_ratio_input D^a_ratio_exp. In the code,
    =the
    =actual particle area is A = R*D^2 (the neglected factor of 4/pi
    =being considered as part uncertainity in
    =the collection efficency of ice/liquid collisions).
!kind=default
ns=namelist/Science/UM Microphysics
range=-1:0
sort-key=Panel-A01a
type=real

[namelist:microphysics=a_ratio_fac]
compulsory=true
description=Prefactor in the cross-sectional area ratio relation ice
help=When the shape-dependent riming rates are used,
    =this is the prefactor
    =used to specify the cross-sectional area of ice particles.
    =The cross-sectional area ratio is given as
    =R(D) = a_ratio_input D^a_ratio_exp. In the code,
    =the
    =actual particle area is A = R*D^2 (the neglected factor of 4/pi
    =being considered as part of the uncertainity in
    =the collection efficency of ice/liquid collisions).
!kind=default
ns=namelist/Science/UM Microphysics
range=0:1
sort-key=Panel-A01b
type=real

[namelist:microphysics=c_r_correl]
compulsory=true
description=Cloud-rain correlation coefficient
help=Cloud-rain correlation coefficient for use with inhomogeneity
    =parametrization in improved warm rain microphysics scheme.
!kind=default
ns=namelist/Science/UM Microphysics
range=-1:1
sort-key=Panel-A05
type=real

[namelist:microphysics=casim_cdnc_opt]
compulsory=true
description=How to calculate cloud number in Casim
!enumeration=true
help=External will take the cloud number calculated by an external aerosol
    = scheme for use in CASIM, e.g. UKCA activate or Glomap climatologies
    = with the Jones relation
    =
    =Fixed number will use a fixed cloud drop number, as in RA3
!kind=default
ns=namelist/Science/UM Microphysics
sort-key=Panel-A02
value-titles=External code, Fixed number
values='external','fixed'

[namelist:microphysics=ci_input]
compulsory=true
description=Prefactor in fallspeed relation of large ice
help=When two different ice fall speeds are used,
    =this is the prefactor
    =used to specify the fallspeed of the large ice particles.
    =The fall speed is given as v(D) = ci_input D^di_input
!kind=default
ns=namelist/Science/UM Microphysics
range=0:1e7
sort-key=Panel-A01b
type=real

[namelist:microphysics=cic_input]
compulsory=true
description=Prefactor in fallspeed relation of small ice
help=When two different ice fall speeds are used,
    =this is the
    =prefactor used to specify the fallspeed of the small ice.
    =The fall speed is given as v(D) = cic_input D^dic_input
!kind=default
ns=namelist/Science/UM Microphysics
range=0:1e7
sort-key=Panel-A01b
type=real

[namelist:microphysics=droplet_tpr]
compulsory=true
description=Enable tapering of cloud droplets towards surface
help=This scheme allows droplet numbers to be tapered from their maximum
    =value down to a lower value towards the surface,
    =and improves
    =microphysical representation during low cloud and fog events.
    =
    =To activate this scheme,
    =activate namelist:microphysics=droplet_tpr
    =z_peak_nd=150.0 m is hard-wired in UM code as height below which to
    =taper the droplet numbers (150m is chosen)
    =Select a value of the droplet number concentration at
    =namelist:microphysics=ndrop_surf - 50.0E6 to 75.0E6 is recommended
    =20.0E6 to 100.0E6 is typical of fog measurements at Cardington MRU.
    =For further information, see Wilkinson et al (2013), QJRMS
    =http://dx.doi.org/10.1002/qj.1975
!kind=default
ns=namelist/Science/UM Microphysics
sort-key=Panel-A02
trigger=namelist:microphysics=ndrop_surf: .true.;
       =namelist:microphysics=z_surf: .true.;
       =namelist:stochastic_physics=rp_mp_ndrop_surf: .true.;
type=logical

[namelist:microphysics=fcrit]
compulsory=true
description=Critical Froude number below which flow blocking occurs
help=Needed by the seeder feeder scheme when blocking is switched on.
    =The amount of low-level blocking due to sub-grid orography is determined
    =by the Froude number F (U/NH).  When F falls below Fcrit, blocking occurs.
    =The blocked layer depth zb increases linearly from zero to the full
    =sub-grid hill peak-to-trough height as F decreases from Fcrit towards zero.
    =The most physically realistic value of fcrit is around 1.
    =Using a larger value increases the amount of blocking and therefore
    =decreases the amount of ascent, resulting in less precipitation enhancement.
    =Value must be greater than zero.
!kind=default
ns=namelist/Science/UM Microphysics
range=0.1:
sort-key=Panel-A04f
type=real

[namelist:microphysics=graupel_scheme]
compulsory=true
description=Option for inclusion of graupel
!enumeration=true
help=Options for the inclusion of a prognostic graupel category in the
    =UM microphysics code.
    =
    = -  No prognostic graupel in use.
    =
    = -  Modified scheme with snow-rain collisions producing graupel,
    =    according to the following table:
    =    ----------------------------------------------------------------
    =    ICE TYPE         | RAIN MIXING RATIO  |   COLLISION RESULTS IN
    =    CRYSTALS         |  > 1.0E-4 KG/KG    |       CRYSTALS
    =    CRYSTALS         |  < 1.0E-4 KG/KG    |       CRYSTALS
    =    SNOW AGGREGATES  |  > 1.0E-4 KG/KG    |       GRAUPEL
    =    SNOW AGGREGATES  |  < 1.0E-4 KG/KG    |       SNOW AGGREGATES
    =    ----------------------------------------------------------------
    =    When the generic ice PSD is switched on, the mean diameter of the
    =    particles is used to determine whether the collision results in ice
    =    aggregates or graupel. If the mean diameter of water is larger, then
    =    graupel particles will be formed.  Otherwise the result of the collision
    =    will be an increase in the mixing ratio of aggregates.
    =
    =    If this option is not selected, then a collision between rain and
    =    crystals produces crystals and similarly, a collision between rain and
    =    aggregates forms aggregates.
!kind=default
ns=namelist/Science/UM Microphysics
sort-key=Panel-A04
value-titles=No graupel,Modified scheme
values='none','modified'

[namelist:microphysics=i_update_precfrac]
compulsory=true
description=Options for how to update the prognostic precip fraction
!enumeration=true
help=If the prognostic precip fraction is used (l_mcr_precfrac=.true.),
    =When any microphysics process increments the prognostic mass of
    =rain and/or graupel, it needs to increment the precip fraction
    =consistently.  The options for how to do this are:
    =(1) - Calculate an updated effective fraction based on the increments
    =      to precip mass squared within assumed homogeneous sub-grid areas.
    =(2) - Calculate the increments to grid-mean precip mass squared based on
    =      assumed correlations between the existing mass and the increments.
!kind=default
ns=namelist/Science/UM Microphysics
sort-key=Panel-A01f
value-titles=Assumed homogenous sub-grid areas,
            =Assumed sub-grid spatial correlations
values='homog','correl'

[namelist:microphysics=l_mcr_precfrac]
compulsory=true
description=Include prognostic rain/graupel fraction
help=Switch to include a prognostic field for the fraction of the
    =grid-box occupied by falling rain and/or graupel.
    =
    =If used, the calculation of the rain fraction in the microphysics
    =scheme is modified to take account of the previous timestep value.
    =When a process adds additional rain/graupel, the new fraction is
    =weighted towards the cloud fraction within-which the new rain/graupel
    =is generated, as a function of the precip mass added.
    =This avoids a problem where the rain fraction can only increase
    =with time unless the rain disappears completely.
    =
    =Graupel is also included in this prognostic sub-grid fraction
    =if prognostic graupel is turned on.
    =
    =Note: you must use prognostic fields for rain or graupel mass
    =in order to use the prognostic precipation fraction.
    =
    =Prognostic precip fraction is not yet available with the CASIM
    =microphysics scheme; it has only been implemented in the Wilson-Ballard
    =scheme code.
ns=namelist/Science/UM Microphysics
sort-key=Panel-A01e
trigger=namelist:microphysics=i_update_precfrac: .true. ;
type=logical

[namelist:microphysics=l_proc_fluxes]
compulsory=true
description=Apply microphysics process rates to the fall-fluxes.
help=If false, the fall-flux of each hydrometeor species cannot be
    = modified by the microphysical processes (once it has been calculated
    = by the sedimentation call).  This leads to numerical problems.
    = For example, if rain is falling, and the model-levels are shallow, then
    = only a small fraction of the fall-flux will remain on a given
    = model-level, with most of it falling straight through.  The small
    = amount of qrain left on the current level after sedimentation
    = may fully evaporate, but most of the rain can spuriously fall through
    = without being subject to evaporation.  This leads to spurious small
    = rain-rates reaching the surface in dry environments, where all the
    = rain should have evaporated before reaching the surface.
    =
    = With this switch set to true, this problem is fixed by allowing
    = microphysical processes to act on the fall-out flux of each
    = species as well as the mass left on the current level.
    =
    =This option is not yet available with the CASIM
    =microphysics scheme; it has only been implemented in the Wilson-Ballard
    =scheme code.
ns=namelist/Science/UM Microphysics
sort-key=Panel-A01d
type=logical

[namelist:microphysics=microphysics_casim]
compulsory=true
description=Run with CASIM scheme
help=Setting to True will switch from the Wilson and Ballard (1999)
    =microphysics scheme to the Cloud-AeroSol Interacting Microphysics
    =(CASIM). This is a multi-moment microphysics scheme which is
    =significantly more advanced and can include complex cloud-aerosol
    =interactions.
!kind=default
ns=namelist/Science/UM Microphysics
sort-key=Panel-A00
trigger=namelist:microphysics=casim_cdnc_opt: .true.;
       =namelist:microphysics=graupel_scheme: .false.;
       =namelist:microphysics=shape_rime: .false.;
       =namelist:microphysics=orog_rain: .false.;
       =namelist:microphysics=prog_tnuc: .false.;
       =namelist:microphysics=c_r_correl: .false.;
       =namelist:microphysics=l_mcr_precfrac: .false.;
       =namelist:microphysics=l_proc_fluxes: .false.;
type=logical

[namelist:microphysics=ndrop_surf]
compulsory=true
description=Surface droplet number concentration when tapering
help=This scheme allows droplet numbers to be tapered from their maximum
    =value down to a lower value towards the surface,
    =and improves
    =microphysical representation during low cloud and fog events.
    =
    =To activate this scheme,
    =activate namelist:microphysics=droplet_tpr
    =z_peak_nd=150.0 m is hard-wired in UM code as height below which to
    =taper the droplet numbers (150m is chosen)
    =Select a value of the droplet number concentration at
    =namelist:microphysics=ndrop_surf - 50.0E6 to 75.0E6 are typical
    =20.0E6 to 100.0E6 was suggested by fog measurements at Cardington MRU.
!kind=default
ns=namelist/Science/UM Microphysics
range=1e6:375e6
sort-key=Panel-A02a
type=real

[namelist:microphysics=nscalesf]
compulsory=true
description=Scaling factor controlling the vertical decay of Seeder Feeder effect
help=The factor used to scale the horizontal wavelength of the assumed
    =sinusoidal ridge in the Seeder Feeder scheme.
    =This is only used to determine the vertical decay rate in the sub-grid
    =orographic vertical displacements (does not determine near-surface values).
    =At any given altitude z, the maximum vertical sub-grid orographic streamline
    =displacement is the effective amplitude of the assumed sinusoidal hill
    =multiplied by exp(-z k / nscalesf), where k is the orography wavenumber.
    =A value of 1 assumes that the sub-grid orographic wavelength is equal to
    =the horizontal model grid spacing.
    =Larger values increase the assumed scale and reduce the vertical decay rate,
    =so that orographic precipitation enhancement will increase at higher levels
    =if the RH is large enough.
    =It is not recommended to go above a value of 6 as those wavelengths
    =are almost completely present in the resolved orography.
!kind=default
ns=namelist/Science/UM Microphysics
range=0.01:6.0
sort-key=Panel-A04c
type=real

[namelist:microphysics=nsigmasf]
compulsory=true
description=Orographic standard deviation scaling factor
help=The factor used to scale the sub-grid orographic standard deviation
    =to estimate the peak-to-trough amplitude of the assumed sinusoidal ridge.
    =Physically this might be approx 2.828427, so that the standard deviation
    =for the assumed sinusoidal ridge is the same as the value for the
    =actual subgrid orography.
    =Larger values increase the hill peak amplitude and therefore the amount
    =of precipitation enhancement produced (unless blocking is increased).
!kind=default
ns=namelist/Science/UM Microphysics
range=0:
sort-key=Panel-A04b
type=real

[namelist:microphysics=orog_block]
compulsory=true
description=Account for low-level blocking in the Seeder Feeder scheme
help=Used by the seeder feeder precipitation enhancement scheme to determine
    =whether to account for sub-grid orographic low-level blocking.
    =Blocking occurs for Froude numbers (U/NH) below fcrit.
    =The effect of blocking is to reduce the effective sub-grid hill height
    =used to estimate the sub-grid orographic water mixing ratio.
!kind=default
ns=namelist/Science/UM Microphysics
sort-key=Panel-A04e
trigger=namelist:microphysics=fcrit: .true.
type=logical

[namelist:microphysics=orog_rain]
compulsory=true
description=Include Seeder Feeder orographic precipitation enhancement
help=This scheme estimates the extra water that would be condensed
    =within a gridbox due to flow over sub-grid hills.
    =This water is not added to the resolved cloud water mixing ratio but
    =is used in an additional accretion (riming) call to produce extra
    =rain (snow). Extra riming only occurs if orog_rime is true.
!kind=default
ns=namelist/Science/UM Microphysics
sort-key=Panel-A04
trigger=namelist:microphysics=orog_rime: .true.;
       = namelist:microphysics=orog_block: .true.;
       = namelist:microphysics=nsigmasf: .true.;
       = namelist:microphysics=nscalesf: .true.;
type=logical

[namelist:microphysics=orog_rime]
compulsory=true
description=Allow the seeder feeder scheme to enhance riming.
help=As standard, the seeder feeder scheme uses the sub-grid orographic
    =water estimate to produce extra rain accretion.
    =This switch allows the scheme to also produce extra snow via riming.
!kind=default
ns=namelist/Science/UM Microphysics
sort-key=Panel-A04d
type=logical

[namelist:microphysics=prog_tnuc]
compulsory=true
description=Turn on prognostic tnuc approach
help=By setting this switch to True,
    =the heterogeneous nucleation temperature
    =will be calculated as a function of dust distribution (instead
    =of -10 deg cel) in the large-scale precipitation.
    =This is further passed to the convection scheme (indexed
    =using the model-level index of the lifting condensation level).
    =In convection scheme, tnuc_new is passed through shallow,deep
    =and mid convection schemes
!kind=default
ns=namelist/Science/UM Microphysics
sort-key=Panel-A01
type=logical

[namelist:microphysics=qcl_rime]
compulsory=true
description=Minimum qcl for riming
help=When the shape-dependent riming rates are used,
    =this specifies how much of the qcl in a gridbox
    =is available for the riming process.
    =Only the fraction of qcl that is above
    =qcl_rime is used to calculate the riming rate.
!kind=default
ns=namelist/Science/UM Microphysics
range=0:1e-02
sort-key=Panel-A01c
type=real

[namelist:microphysics=shape_rime]
compulsory=true
description=Use ice particle shape-dependent riming rate
help=This code makes the riming rate depend on the cross-sectional
    =area of the ice/snow crystals. The parametrization of area
    =in terms of particle size from Heymsfield and
    =Miloshevich (J. Atmos. Sci.,
    =60,936 (2003)) is used.
    =It also includes a minimum qcl,
    =above which liquid water
    =is available for riming. This follows the findings of
    =Harimaya (J. Meteor. Japan,
    =53(6),
    =384-392) that
    =there is a minimum droplet size for riming to occur.
!kind=default
ns=namelist/Science/UM Microphysics
sort-key=Panel-A01
trigger=namelist:microphysics=a_ratio_fac: .true.;
       = namelist:microphysics=a_ratio_exp: .true.;
       = namelist:microphysics=qcl_rime: .true.;
type=logical

[namelist:microphysics=turb_gen_mixph]
compulsory=true
description=Include turbulent production of mixed phase cloud?
help=By setting this switch to True,
    =the turbulent production of mixed phase
    =cloud scheme is activated.
!kind=default
ns=namelist/Science/UM Microphysics
sort-key=Panel-A03
type=logical

[namelist:microphysics=z_surf]
compulsory=true
description=Height (m)  at which taper reaches ndrop_surf
help=This sets the height (m) above the surface at which the droplet taper
    =reaches the value of ndrop_surf. The droplet number then remains
    =constant at this value below this height. Setting at value of 0
    =will just result in model level 1 being used.
    =Value must be <= z_peak_nd which is now hard-wired to 150.0 in UM code.
    =
    =In the, somewhat peculiar, case of drop number decreasing with height
    =it will always taper to ndrop_surf at level 1.
!kind=default
ns=namelist/Science/UM Microphysics
range=0.0:150.0
sort-key=Panel-A02b
type=real
